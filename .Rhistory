geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = "Rivers and waterways of the United States")
load("data/map.Rdata")
ggplot(data = bound) +
geom_sf() +
geom_path(data = df.usa_rivers,
aes(x = long, y = lat, group = group),
color = "#8ca7c0", size = 1.5) +
geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = "Rivers and waterways of the United States")
ggplot(data = bound) +
geom_sf() +
geom_path(data = df.usa_rivers,
aes(x = long, y = lat, group = group),
color = "#8ca7c0", size = 1.5, alpha = 0.5) +
geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = "Rivers and waterways of the United States")
ggplot(data = bound) +
geom_sf() +
geom_path(data = df.usa_rivers,
aes(x = long, y = lat, group = group),
color = "blue", size = 1.5, alpha = 0.5) +
geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = "Rivers and waterways of the United States")
ggplot(data = bound) +
geom_sf() +
geom_path(data = df.usa_rivers,
aes(x = long, y = lat, group = group),
color = "skyblue", size = 1.5, alpha = 0.5) +
geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = "Rivers and waterways of the United States")
Quantile <- paste0("Q", c(0.05, 0.1, 0.2, 0.5, 0.7, 0.9, 0.95, 0.975, 0.99))
for(i in 1:length(Quantile)){
u <- RiverSummary %>% select(station, Quantile[i])
MeanExceedance <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station")) %>%
filter(if(Quantile[i]<0.5) Q < Quantile[i] else Q > Quantile[i]) %>%
group_by(station) %>%
summarise(MeanExceedance = mean(Q)) %>%
left_join((Siteinfor %>% select(site_no, dec_long_va, dec_lat_va)),
c("station" = "site_no"))
ggplot(data = bound) +
geom_sf() +
geom_path(data = df.usa_rivers,
aes(x = long, y = lat, group = group),
color = "skyblue", size = 1.5, alpha = 0.5) +
geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = paste("MeanExceedance of", Quantile[i]))
}
}
for(i in 1:length(Quantile)){
u <- RiverSummary %>% select(station, Quantile[i])
MeanExceedance <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station")) %>%
filter(if(Quantile[i]<0.5) Q < Quantile[i] else Q > Quantile[i]) %>%
group_by(station) %>%
summarise(MeanExceedance = mean(Q)) %>%
left_join((Siteinfor %>% select(site_no, dec_long_va, dec_lat_va)),
c("station" = "site_no"))
ggplot(data = bound) +
geom_sf() +
geom_path(data = df.usa_rivers,
aes(x = long, y = lat, group = group),
color = "skyblue", size = 1.5, alpha = 0.5) +
geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = paste("MeanExceedance of", Quantile[i]))
}
length(Quantile)
for(i in 1:2){
u <- RiverSummary %>% select(station, Quantile[i])
MeanExceedance <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station")) %>%
filter(if(Quantile[i]<0.5) Q < Quantile[i] else Q > Quantile[i]) %>%
group_by(station) %>%
summarise(MeanExceedance = mean(Q)) %>%
left_join((Siteinfor %>% select(site_no, dec_long_va, dec_lat_va)),
c("station" = "site_no"))
ggplot(data = bound) +
geom_sf() +
geom_path(data = df.usa_rivers,
aes(x = long, y = lat, group = group),
color = "skyblue", size = 1.5, alpha = 0.5) +
geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = paste("MeanExceedance of", Quantile[i]))
}
for(i in 1:1){
u <- RiverSummary %>% select(station, Quantile[i])
MeanExceedance <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station")) %>%
filter(if(Quantile[i]<0.5) Q < Quantile[i] else Q > Quantile[i]) %>%
group_by(station) %>%
summarise(MeanExceedance = mean(Q)) %>%
left_join((Siteinfor %>% select(site_no, dec_long_va, dec_lat_va)),
c("station" = "site_no"))
ggplot(data = bound) +
geom_sf() +
geom_path(data = df.usa_rivers,
aes(x = long, y = lat, group = group),
color = "skyblue", size = 1.5, alpha = 0.5) +
geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = paste("MeanExceedance of", Quantile[i]))
}
u <- RiverSummary %>% select(station, Quantile[i])
MeanExceedance <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station")) %>%
filter(if(Quantile[i]<0.5) Q < Quantile[i] else Q > Quantile[i]) %>%
group_by(station) %>%
summarise(MeanExceedance = mean(Q)) %>%
left_join((Siteinfor %>% select(site_no, dec_long_va, dec_lat_va)),
c("station" = "site_no"))
ggplot(data = bound) +
geom_sf() +
geom_path(data = df.usa_rivers,
aes(x = long, y = lat, group = group),
color = "skyblue", size = 1.5, alpha = 0.5) +
geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = paste("MeanExceedance of", Quantile[i]))
for(i in 1:length(Quantile)){
u <- RiverSummary %>% select(station, Quantile[i])
MeanExceedance <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station")) %>%
filter(if(Quantile[i]<0.5) Q < Quantile[i] else Q > Quantile[i]) %>%
group_by(station) %>%
summarise(MeanExceedance = mean(Q)) %>%
left_join((Siteinfor %>% select(site_no, dec_long_va, dec_lat_va)),
c("station" = "site_no"))
ggplot(data = bound) +
geom_sf() +
geom_path(data = df.usa_rivers,
aes(x = long, y = lat, group = group),
color = "skyblue", size = 1.5, alpha = 0.5) +
geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = paste("MeanExceedance of", Quantile[i]))
}
i=1
u <- RiverSummary %>% select(station, Quantile[i])
MeanExceedance <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station")) %>%
filter(if(Quantile[i]<0.5) Q < Quantile[i] else Q > Quantile[i]) %>%
group_by(station) %>%
summarise(MeanExceedance = mean(Q)) %>%
left_join((Siteinfor %>% select(site_no, dec_long_va, dec_lat_va)),
c("station" = "site_no"))
u <- RiverSummary %>% select(station, Quantile[i])
MeanExceedance <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station")) %>%
filter(if(Quantile[i]<0.5) Q < Quantile[i] else Q > Quantile[i]) %>%
group_by(station) %>%
summarise(MeanExceedance = mean(Q)) %>%
left_join((Siteinfor %>% select(site_no, dec_long_va, dec_lat_va)),
c("station" = "site_no"))
data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station")) %>%
filter(if(Quantile[i]<0.5) Q < Quantile[i] else Q > Quantile[i])
data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station"))
Quantile[i]
data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station")) %>%
filter(if(Quantile[i]<0.5) Q < get(Quantile[i]) else Q > Quantile[i])
get(Quantile[i])
data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station")) %>%
mutate(u = Quantile[i])
MeanExceedance <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station")) %>%
mutate(u = get(Quantile[i]))
data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station")) %>%
mutate(u = get(Quantile[i]))
data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station")) %>%
mutate(u = get(Quantile[i])) %>%
filter(if(Quantile[i]<0.5) Q < u else Q > u)
for(i in 1:length(Quantile)){
u <- RiverSummary %>% select(station, Quantile[i])
MeanExceedance <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station")) %>%
mutate(u = get(Quantile[i])) %>%
filter(if(Quantile[i]<0.5) Q < u else Q > u) %>%
group_by(station) %>%
summarise(MeanExceedance = mean(Q)) %>%
left_join((Siteinfor %>% select(site_no, dec_long_va, dec_lat_va)),
c("station" = "site_no"))
ggplot(data = bound) +
geom_sf() +
geom_path(data = df.usa_rivers,
aes(x = long, y = lat, group = group),
color = "skyblue", size = 1.5, alpha = 0.5) +
geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = paste("MeanExceedance of", Quantile[i]))
}
MeanExceedance <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station")) %>%
mutate(u = get(Quantile[i])) %>%
filter(if(Quantile[i]<0.5) Q < u else Q > u) %>%
group_by(station) %>%
summarise(MeanExceedance = mean(Q)) %>%
left_join((Siteinfor %>% select(site_no, dec_long_va, dec_lat_va)),
c("station" = "site_no"))
ggplot(data = bound) +
geom_sf() +
geom_path(data = df.usa_rivers,
aes(x = long, y = lat, group = group),
color = "skyblue", size = 1.5, alpha = 0.5) +
geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = paste("MeanExceedance of", Quantile[i]))
paste("plot/", Quantile[i],".SVG")
paste0("plot/", Quantile[i],".SVG")
for(i in 1:length(Quantile)){
u <- RiverSummary %>% select(station, Quantile[i])
MeanExceedance <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station")) %>%
mutate(u = get(Quantile[i])) %>%
filter(if(Quantile[i]<0.5) Q < u else Q > u) %>%
group_by(station) %>%
summarise(MeanExceedance = mean(Q)) %>%
left_join((Siteinfor %>% select(site_no, dec_long_va, dec_lat_va)),
c("station" = "site_no"))
ggplot(data = bound) +
geom_sf() +
geom_path(data = df.usa_rivers,
aes(x = long, y = lat, group = group),
color = "skyblue", size = 1.5, alpha = 0.5) +
geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = paste("MeanExceedance of", Quantile[i]))
ggsave(paste0("plot/", Quantile[i],".SVG"), plot = last_plot())
}
for(i in 1:length(Quantile)){
u <- RiverSummary %>% select(station, Quantile[i])
MeanExceedance <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station")) %>%
mutate(u = get(Quantile[i])) %>%
filter(if(Quantile[i]<0.5) Q < u else Q > u) %>%
group_by(station) %>%
summarise(MeanExceedance = mean(Q)) %>%
left_join((Siteinfor %>% select(site_no, dec_long_va, dec_lat_va)),
c("station" = "site_no"))
ggplot(data = bound) +
geom_sf() +
geom_path(data = df.usa_rivers,
aes(x = long, y = lat, group = group),
color = "skyblue", size = 1.5, alpha = 0.5) +
geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = paste("MeanExceedance of", Quantile[i]))
ggsave(paste0("plot/", Quantile[i],".png"), plot = last_plot())
}
RiverSummary <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
group_by(station, Month) %>%
summarise(
mean = mean(Q),
sd = sd(Q),
Q0.05 = quantile(Q, 0.05),
Q0.1 = quantile(Q, 0.1),
Q0.2 = quantile(Q, 0.2),
Q0.5 = quantile(Q, 0.5),
Q0.7 = quantile(Q, 0.7),
Q0.9 = quantile(Q, 0.9),
Q0.95 = quantile(Q, 0.95),
Q0.975 = quantile(Q, 0.975),
Q0.99 = quantile(Q, 0.99)
)
View(RiverSummary)
RiverSummary %>% select(station, Moonth, Quantile[i])
RiverSummary %>% select(station, Month, Quantile[i])
u <- RiverSummary %>% select(station, Month, Quantile[i])
RiverSummary <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
group_by(station, DecYear) %>%
summarise(
mean = mean(Q),
sd = sd(Q),
Q0.05 = quantile(Q, 0.05),
Q0.1 = quantile(Q, 0.1),
Q0.2 = quantile(Q, 0.2),
Q0.5 = quantile(Q, 0.5),
Q0.7 = quantile(Q, 0.7),
Q0.9 = quantile(Q, 0.9),
Q0.95 = quantile(Q, 0.95),
Q0.975 = quantile(Q, 0.975),
Q0.99 = quantile(Q, 0.99)
)
Quantile <- paste0("Q", c(0.05, 0.1, 0.2, 0.5, 0.7, 0.9, 0.95, 0.975, 0.99))
data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station", "DecYear" = "DecYear")) %>%
mutate(u = get(Quantile[i]))
RiverSummary <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
group_by(station, DecYear) %>%
summarise(
mean = mean(Q),
sd = sd(Q),
Q0.05 = quantile(Q, 0.05),
Q0.1 = quantile(Q, 0.1),
Q0.2 = quantile(Q, 0.2),
Q0.5 = quantile(Q, 0.5),
Q0.7 = quantile(Q, 0.7),
Q0.9 = quantile(Q, 0.9),
Q0.95 = quantile(Q, 0.95),
Q0.975 = quantile(Q, 0.975),
Q0.99 = quantile(Q, 0.99)
)
Quantile <- paste0("Q", c(0.05, 0.1, 0.2, 0.5, 0.7, 0.9, 0.95, 0.975, 0.99))
u <- RiverSummary %>% select(station, DecYear, Quantile[i])
View(u)
data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station", "DecYear" = "DecYear")) %>%
mutate(u = get(Quantile[i]))
MeanExceedance <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station", "DecYear" = "DecYear")) %>%
mutate(u = get(Quantile[i])) %>%
filter(if(Quantile[i]<0.5) Q < u else Q > u) %>%
group_by(station) %>%
summarise(MeanExceedance = mean(Q)) %>%
left_join((Siteinfor %>% select(site_no, dec_long_va, dec_lat_va)),
c("station" = "site_no"))
ggplot(data = bound) +
geom_sf() +
geom_path(data = df.usa_rivers,
aes(x = long, y = lat, group = group),
color = "skyblue", size = 1.5, alpha = 0.5) +
geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = paste("MeanExceedance of", Quantile[i])) +
facet_wrap(~DecYear)
MeanExceedance
data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station", "DecYear" = "DecYear")) %>%
mutate(u = get(Quantile[i])) %>%
filter(if(Quantile[i]<0.5) Q < u else Q > u) %>%
group_by(station) %>%
summarise(MeanExceedance = mean(Q))
data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station", "DecYear" = "DecYear")) %>%
mutate(u = get(Quantile[i])) %>%
filter(if(Quantile[i]<0.5) Q < u else Q > u) %>%
group_by(station, DecYear) %>%
summarise(MeanExceedance = mean(Q))
MeanExceedance <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station", "DecYear" = "DecYear")) %>%
mutate(u = get(Quantile[i])) %>%
filter(if(Quantile[i]<0.5) Q < u else Q > u) %>%
group_by(station, DecYear) %>%
summarise(MeanExceedance = mean(Q)) %>%
left_join((Siteinfor %>% select(site_no, dec_long_va, dec_lat_va)),
c("station" = "site_no"))
MeanExceedance
ggplot(data = bound) +
geom_sf() +
geom_path(data = df.usa_rivers,
aes(x = long, y = lat, group = group),
color = "skyblue", size = 1.5, alpha = 0.5) +
geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = paste("MeanExceedance of", Quantile[i])) +
facet_wrap(~DecYear)
for(i in 1:length(Quantile)){
u <- RiverSummary %>% select(station, DecYear, Quantile[i])
MeanExceedance <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station", "DecYear" = "DecYear")) %>%
mutate(u = get(Quantile[i])) %>%
filter(if(Quantile[i]<0.5) Q < u else Q > u) %>%
group_by(station, DecYear) %>%
summarise(MeanExceedance = mean(Q)) %>%
left_join((Siteinfor %>% select(site_no, dec_long_va, dec_lat_va)),
c("station" = "site_no"))
ggplot(data = bound) +
geom_sf() +
geom_path(data = df.usa_rivers,
aes(x = long, y = lat, group = group),
color = "skyblue", size = 1.5, alpha = 0.5) +
geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = paste("MeanExceedance of", Quantile[i])) +
facet_wrap(~DecYear)
ggsave(paste0("plot/Spatiotemporal", Quantile[i],".png"), plot = last_plot())
ggsave(paste0("plot/Spatiotemporal", Quantile[i],".SVG"), plot = last_plot())
}
for(i in 1:length(Quantile)){
u <- RiverSummary %>% select(station, DecYear, Quantile[i])
MeanExceedance <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station", "DecYear" = "DecYear")) %>%
mutate(u = get(Quantile[i])) %>%
filter(if(Quantile[i]<0.5) Q < u else Q > u) %>%
group_by(station, DecYear) %>%
summarise(MeanExceedance = mean(Q)) %>%
left_join((Siteinfor %>% select(site_no, dec_long_va, dec_lat_va)),
c("station" = "site_no"))
ggplot(data = bound) +
geom_sf() +
geom_path(data = df.usa_rivers,
aes(x = long, y = lat, group = group),
color = "skyblue", size = 1.5, alpha = 0.5) +
geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = paste("MeanExceedance of", Quantile[i])) +
facet_wrap(~DecYear)
ggsave(paste0("plot/Spatiotemporal", Quantile[i],".png"), plot = last_plot(),dpi=800)
ggsave(paste0("plot/Spatiotemporal", Quantile[i],".SVG"), plot = last_plot(),dpi=800)
}
for(i in 1:length(Quantile)){
u <- RiverSummary %>% select(station, DecYear, Quantile[i])
MeanExceedance <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station", "DecYear" = "DecYear")) %>%
mutate(u = get(Quantile[i])) %>%
filter(if(Quantile[i]<0.5) Q < u else Q > u) %>%
group_by(station, DecYear) %>%
summarise(MeanExceedance = mean(Q)) %>%
left_join((Siteinfor %>% select(site_no, dec_long_va, dec_lat_va)),
c("station" = "site_no"))
ggplot(data = bound) +
geom_sf() +
geom_path(data = df.usa_rivers,
aes(x = long, y = lat, group = group),
color = "skyblue", size = 1.5, alpha = 0.5) +
geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = paste("MeanExceedance of", Quantile[i])) +
facet_wrap(~DecYear)
ggsave(paste0("plot/Spatiotemporal", Quantile[i],".png"), plot = last_plot(),dpi=1200)
ggsave(paste0("plot/Spatiotemporal", Quantile[i],".SVG"), plot = last_plot(),dpi=1200)
}
for(i in 1:length(Quantile)){
u <- RiverSummary %>% select(station, DecYear, Quantile[i])
MeanExceedance <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station", "DecYear" = "DecYear")) %>%
mutate(u = get(Quantile[i])) %>%
filter(if(Quantile[i]<0.5) Q < u else Q > u) %>%
group_by(station, DecYear) %>%
summarise(MeanExceedance = mean(Q)) %>%
left_join((Siteinfor %>% select(site_no, dec_long_va, dec_lat_va)),
c("station" = "site_no"))
ggplot(data = bound) +
geom_sf() +
geom_path(data = df.usa_rivers,
aes(x = long, y = lat, group = group),
color = "skyblue", size = 1.5, alpha = 0.5) +
geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = paste("MeanExceedance of", Quantile[i])) +
facet_wrap(~DecYear)
ggsave(paste0("plot/Spatiotemporal", Quantile[i],".png"), plot = last_plot(),height=12,width=9,dpi=72)
ggsave(paste0("plot/Spatiotemporal", Quantile[i],".SVG"), plot = last_plot(),dpi=1200)
}
for(i in 1:length(Quantile)){
u <- RiverSummary %>% select(station, DecYear, Quantile[i])
MeanExceedance <- data %>%
select("station", "Q", "DecYear", "Month", "River") %>%
left_join(u, c("station" = "station", "DecYear" = "DecYear")) %>%
mutate(u = get(Quantile[i])) %>%
filter(if(Quantile[i]<0.5) Q < u else Q > u) %>%
group_by(station, DecYear) %>%
summarise(MeanExceedance = mean(Q)) %>%
left_join((Siteinfor %>% select(site_no, dec_long_va, dec_lat_va)),
c("station" = "site_no"))
ggplot(data = bound) +
geom_sf() +
geom_path(data = df.usa_rivers,
aes(x = long, y = lat, group = group),
color = "skyblue", size = 1.5, alpha = 0.5) +
geom_point(data = MeanExceedance, aes(x = dec_long_va, y = dec_lat_va, color = MeanExceedance), size = 2)+
coord_sf(xlim = c(-98,-89), ylim = c(40,48)) +
labs(title = paste("MeanExceedance of", Quantile[i])) +
facet_wrap(~DecYear)
ggsave(paste0("plot/Spatiotemporal", Quantile[i],".png"), plot = last_plot(),height=12,width=9)
ggsave(paste0("plot/Spatiotemporal", Quantile[i],".SVG"), plot = last_plot())
}
